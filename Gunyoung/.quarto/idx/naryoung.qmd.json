{"title":"project8","markdown":{"yaml":{"title":"project8","author":"신나령","format":"html","editor":"visual"},"headingText":"팀: 2조","containsRefs":false,"markdown":"\n\n\n#### 주제: 화학 성분에 따른 레드 와인 품질 예측 분석\n\n#### 방식: 이항로지스틱회귀분석\n\n##### 출처: https://www.kaggle.com/datasets/uciml/red-wine-quality-cortez-et-al-2009\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nknitr::opts_chunk$set(warning = FALSE)\n```\n\n### 데이터 불러오기\n\n```{r}\ndf <- read.csv('./winequality-red.csv')\nstr(df)\n```\n\n### 결측치 확인\n\n```{r}\nsum(is.na(df))\n```\n\n### 데이터 이상치 확인\n\n```{r}\n# 처리 전\nnrow(df)\n\nboxplot(df)\noutlier <- boxplot.stats(df$total.sulfur.dioxide)$out\ndf[df$total.sulfur.dioxide %in% outlier,] <- NA \ndf <- na.omit(df) # 결측치 삭제\n\n# 처리한 후\nnrow(df)\n```\n\n## 1. 품질별 레드와인 수\n\n```{r}\nbarplot(table(df$quality),col='#880000',\n        main='Number of red wines by quality',ylab='count',xlab='quality')\n```\n\n##### · 중간 등급이 많고, 품질이 나쁘거나 좋은 건 소수\n\n## 2. 컬럼별 상관관계\n\n```{r}\n# 파랑-양, 빨강-음, 색이 진할수록 강함\nlibrary(corrgram)\ncorrgram(df,order=TRUE,lower.panel = panel.shade,upper.panel = panel.cor,\n         text.panel = panel.txt, main=\"reds wine corrgram\")\n```\n\n##### · 품질과 상관관계가 있는 건 알콜(0.47)과 휘발성 산(-0.39)\n\n```{r}\npar(mfrow=c(1,2))\nboxplot(df$alcohol~df$quality,col=terrain.colors(6),\n        main = 'Alcohol of red wines by quality',\n        xlab = 'quality', ylab = 'alcohol')\nboxplot(df$volatile.acidity~df$quality,col=terrain.colors(6),\n        main = 'Volatile acidity of red wines by quality',\n        xlab = 'quality', ylab = 'volatile acidity')\npar(mfrow=c(1,1))\n```\n\n##### · 알콜은 양의 상관, 휘발성 산은 음의 상관\n\n```{r}\ncor.test(df$quality,df$alcohol)\ncor.test(df$quality,df$volatile.acidity)\n```\n\n##### · cor.test 결과 두 변수 다 유의확률이 0.05 미만\n\n## 3. 이항로지스틱회귀분석\n\n```{r}\n# 결과변수는 이분형 범주여야 해서 품질을 7이상이면 yes, 미만이면 no로 2개의 등급을 따로 만들어 줌\ndf$is.quality <- factor(ifelse(df$quality>=7,'Yes','No'))\nbarplot(table(df$is.quality),col='#880000')\n```\n\n##### · 품질이 좋은 게 상대적으로 적음\n\n```{r}\ndf <- df[,-12] # 원래 있던 quality 변수 삭제\nmodel <- glm(is.quality ~ .,data=df,family = binomial(link='logit'))\nsummary(model)\n```\n\n##### · volatile.acidity, residual.sugar, chlorides, total.sulfur.dioxide, sulphates, alcohol (휘발성 산, 잔여당, 염화율, 전체 이산화황, 황산염, 알콜) 변수들의 유의확률이 0.05보다 작음\n\n##### · 휘발성 산, 염화율, 전체 이산화황 변수들은 낮아질수록 품질이 좋아지고, 잔여당, 황산염, 알콜변수들은 증가할수록 품질이 좋아짐\n\n```{r}\nodds <- exp(cbind(OR=coef(model),confint(model)))\nodds\n```\n\n##### · 오즈비는 황산염, 알콜이 가장 큼\n\n##### · 황산염 값이 1 증가하면 품질이 높아질 확률이 약 98배 증가하고, 알콜은 1증가하면 품질이 높아질 확률이 약 2.25배 증가\n\n## 3. 원래 분류 모델 ROC 그래프\n\n```{r}\nlibrary(pROC)\n# 독립변수 다 포함\nroc(is.quality~ model$fitted.values,data=df,plot=TRUE,\n    main='ROC CURVE',col='tomato')\n```\n\n##### · 모든 독립변수 다 넣었을 때 AUC 값이 0.8827\n\n## 4-(1). 새로운 분류 모델 ROC 그래프\n\n```{r}\n# 유의한 변수들만 넣어서 다시 모델 만듦\nre.model <- glm(is.quality ~ volatile.acidity+residual.sugar+chlorides +total.sulfur.dioxide+sulphates+alcohol,data=df,family = binomial(link='logit'))\nroc(is.quality~ re.model$fitted.values,data=df,plot=TRUE,\n    main='ROC CURVE',col='tomato')\n```\n\n##### · 위에서 확인한 유의확률이 높은 독립변수들(휘발성 산, 잔여당, 염화율, 전체 이산화황, 황산염, 알콜)만 넣었을 때 AUC 값이 0.8775\n\n## 4-(2). 혼동행렬\n\n```{r}\n# 결과변수는 일정 기준값인 0.5보다 크면 사건이 발생한 것으로 간주\ndf$pred <- factor(ifelse(re.model$fitted.values > 0.5,'Yes','No'))\ntab <- table(df$is.quality,df$pred)\ntab\nmosaicplot(~pred+is.quality,data=df,color = TRUE,main = 'Confusion matrix',ylab='실제',xlab='예측')\n```\n\n```{r}\n# 분류모델의 성능평가지표\n# 정확도 계산\nTP <- tab[2,2]\nTN <- tab[1,1]\nFP <- tab[1,2]\nFN <- tab[2,1]\naccurancy <- (TP+TN)/(TP+TN+FP+FN)\naccurancy\n```\n\n##### · 정확도(참과 거짓을 정확히 맞힌 비율) 높음\n\n##### **\\[결론\\]** 새로운 분류 모델의 AUC 값이 원래 분류 모델의 AUC 값과 별다른 차이가 없고, 정확도가 0.88 정도로 높은 것으로 보아 회귀모델이 적합하다고 볼 수 있음\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["style.css"],"output-file":"naryoung.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","theme":"cosmo","title":"project8","author":"신나령","editor":"visual"},"extensions":{"book":{"multiFile":true}}}}}