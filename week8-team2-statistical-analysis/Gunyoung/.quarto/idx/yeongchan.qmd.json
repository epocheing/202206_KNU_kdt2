{"title":"yeongchan","markdown":{"yaml":{"title":"yeongchan","author":"yc","editor":"visual"},"headingText":"목표 : 응답결과에 따른 연령, 교육수준, 나이 관련성","containsRefs":false,"markdown":"\n\n\n# 25항까지는 설문항목, 26\\~28항까지는 연령, 교육수준, 나이\n\n```{r}\nlibrary(psychTools) \nlibrary(psych)\nlibrary(corrplot)\nbfiDF_2nd <- bfi\nbfiDF_omit <- na.omit(bfiDF_2nd)\n```\n\n# O개방성\n\n# C성실성\n\n# E외향성\n\n# A우호성\n\n# N신경증\n\n# 성별, 교육, 나이 범주화----\n\n```{r}\nbfiDF_omit$f_gender <- factor(bfiDF_omit$gender, levels = c(1, 2), labels = c('Males', 'Females'))\nbfiDF_omit$f_education <- factor(bfiDF_omit$education, levels = c(1, 2, 3, 4, 5),\n                                 labels = c('HS', 'finished HS',\n                                            'some college', 'college graduate',\n                                            'graduate degree'))\nbfiDF_omit$f_age <- cut(bfiDF_omit$age, breaks = c(0,10,20,30,40,50,60,70,80,90),\n    labels = c('under 10', '10s', '20s','30s', '40s', '50s', '60s', '70s',\n               '80s'))\n```\n\n# barplot ----\n\n```{r}\n# par(mfrow=c(4,4))\n# 성별, 교육, 나이 그래프\nbarplot(table(bfiDF_omit$f_gender), main='gender')\n# 성별 응답자 중 여성이 많음\nbarplot(table(bfiDF_omit$f_education), main='education')\n# 교육수준별 응답자 중 대재가 가장 많음\nbarplot(table(bfiDF_omit$age), main='age')\n# 연령별 응답자 중 20살이 가장 많음\n# par(mfrow=c(1,1))\n```\n\n# 각 설문항목의 합----\n\n```{r}\nbfiDF_omit$sum_A <- bfiDF_omit[,1]+bfiDF_omit[,2]+bfiDF_omit[,3]+bfiDF_omit[,4]+bfiDF_omit[,5]\nbfiDF_omit$sum_C <- bfiDF_omit[,6]+bfiDF_omit[,7]+bfiDF_omit[,8]+bfiDF_omit[,9]+bfiDF_omit[,10]\nbfiDF_omit$sum_E <- bfiDF_omit[,11]+bfiDF_omit[,12]+bfiDF_omit[,13]+bfiDF_omit[,14]+bfiDF_omit[,15]\nbfiDF_omit$sum_N <- bfiDF_omit[,16]+bfiDF_omit[,17]+bfiDF_omit[,18]+bfiDF_omit[,19]+bfiDF_omit[,20]\nbfiDF_omit$sum_O <- bfiDF_omit[,21]+bfiDF_omit[,22]+bfiDF_omit[,23]+bfiDF_omit[,24]+bfiDF_omit[,25]\n\n```\n\n```{r}\n#?barplot()\nbarplot(table(bfiDF_omit$sum_A), xlim = c(0,32),\n        ylim = c(0,300), main='Sum of Agreeableness') #22\nbarplot(table(bfiDF_omit$sum_C), xlim = c(0,32),\n        ylim = c(0,320), main='Sum of Conscientiousness') #20\nbarplot(table(bfiDF_omit$sum_E), xlim = c(0,32),\n        ylim = c(0,320), main='Sum of Extraversion') #19\nbarplot(table(bfiDF_omit$sum_N), xlim = c(0,32),\n        ylim = c(0,120), main='Sum of Neuroticism') #14\nbarplot(table(bfiDF_omit$sum_O), xlim = c(0,32),\n        ylim = c(0,420), main='Sum of Openness') #20\n```\n\n# N(신경증) 항목은 다른 항목에 비해 부정적인 면이 강해서 수치가 고루 분포 된것으로 확인되었습니다.\n\n# 카이제곱 검정 시작----\n\n# 카이제곱 검정(성별, 교육수준)\n\n```{r}\ntable(bfiDF_omit$f_gender, bfiDF_omit$f_education)\n\nchisq.test(table(bfiDF_omit$f_gender, bfiDF_omit$f_education))\n\n```\n\n# 응답자의 성별과 교육수준은 통계적 유의성이 있다.\n\n# 카이제곱 검정(성별, 연령)\n\n```{r}\ntable(bfiDF_omit$f_gender, bfiDF_omit$f_age)\n\nchisq.test(table(bfiDF_omit$f_gender, bfiDF_omit$f_age))\n\n```\n\n# p-value가 0.05보다 작으므로 응답자의 성별과 나이는 통계적 유의성이 있다.\n\n# 카이제곱 검정(교육수준, 연령)\n\n```{r}\ntable(bfiDF_omit$f_education, bfiDF_omit$f_age)\n  \nchisq.test(table(bfiDF_omit$f_education, bfiDF_omit$f_age))\n\n```\n\n# 상관관계\n\n```{r}\nstr(bfiDF_omit)\ncorr.test(bfiDF_omit[,c(27,32:36)])\n# p-value=>education-sum_A 0.03,\n# # A우호성\n# education-sum_C => 0.01\n# # C성실성\n# corrplot(bfiDF_omit[c(,27,31:35)])\ncorData <- bfiDF_omit[,c(27,32:36)]\ncorMatrix <- cor(corData)\ncorMatrix\ncorrplot(corMatrix)\n```\n\n# 다항 선형회귀\n\n```{r}\nlibrary(car)\n\nform_multi_age_A <- sum_A~age+I(age^2)\nlm(form_multi_age_A, data=bfiDF_omit)\nmodel_multi_age_A <- lm(form_multi_age_A, data=bfiDF_omit)\nplot(sum_A~age, data=bfiDF_omit, pch=19,\n     col='steelblue')\nlibrary(dplyr)\nwith(bfiDF_omit,\n     lines(arrange(data.frame(age, fitted(model_multi_age_A)), age),\n           lty=1, lwd=3, col='tomato'))\nsummary(model_multi_age_A)\nanova(model_multi_age_A)\n\n# form_age_sA <- age~sum_A\n# model_age_sA <- lm(formula=form_age_sA, data=bfiDF_omit)\n# abline(model_age_sA, lwd=2, col='tomato')\n# summary(model_age_sA)\n# anova(model_age_sA)\n```\n\n# 분석: 나이가 많아질수록 우호성(A)이 좋아지다가 낮아진다\n\n```{r}\nsummary(aov(sum_A~f_age, data=bfiDF_omit))\nstr(bfiDF_omit$f_age)\n\n```\n\n# 다항선형회귀(나이와 항목C)\n\n```{r}\n\nform_multi_age_C <- sum_C~age+I(age^2)\nlm(form_multi_age_C, data=bfiDF_omit)\nmodel_multi_age_C <- lm(form_multi_age_C, data=bfiDF_omit)\nplot(sum_C~age, data=bfiDF_omit, pch=19,\n     col='steelblue')\nlibrary(dplyr)\nwith(bfiDF_omit,\n     lines(arrange(data.frame(age, fitted(model_multi_age_C)), age),\n           lty=1, lwd=3, col='tomato'))\nsummary(model_multi_age_C)\nanova(model_multi_age_C)\n```\n\n# 분석: 성실성(C)은 나이가 많아질 수록 낮아짐을 확인할 수 있었습니다.\n\n# 다항선형회귀(나이와 항목E)\n\n```{r}\nform_multi_age_E <- sum_E~age+I(age^2)\nlm(form_multi_age_E, data=bfiDF_omit)\nmodel_multi_age_E <- lm(form_multi_age_E, data=bfiDF_omit)\nplot(sum_E~age, data=bfiDF_omit, pch=19,\n     col='steelblue')\nlibrary(dplyr)\nwith(bfiDF_omit,\n     lines(arrange(data.frame(age, fitted(model_multi_age_E)), age),\n           lty=1, lwd=3, col='tomato'))\nsummary(model_multi_age_E)\nanova(model_multi_age_E)\n```\n\n# 분석: 나이가 많아질수록 외향성(E)이 낮아진다.\n\n# 다항선형회귀(나이와 항목N)\n\n```{r}\n\nform_multi_age_N <- sum_N~age+I(age^2)\nlm(form_multi_age_N, data=bfiDF_omit)\nmodel_multi_age_N <- lm(form_multi_age_N, data=bfiDF_omit)\nplot(sum_N~age, data=bfiDF_omit, pch=19,\n     col='steelblue')\nlibrary(dplyr)\nwith(bfiDF_omit,\n     lines(arrange(data.frame(age, fitted(model_multi_age_N)), age),\n           lty=1, lwd=3, col='tomato'))\nsummary(model_multi_age_N)\nanova(model_multi_age_N)\n```\n\n# 분석: 신경증(N)은 20세 근처에서 최대였다가 나이가 많아질수록 감소함.\n\n# 다항선형회귀(나이와 항목O)\n\n```{r}\n\nform_multi_age_O <- sum_O~age+I(age^2)\nlm(form_multi_age_O, data=bfiDF_omit)\nmodel_multi_age_O <- lm(form_multi_age_O, data=bfiDF_omit)\nplot(sum_O~age, data=bfiDF_omit, pch=19,\n     col='steelblue')\nlibrary(dplyr)\nwith(bfiDF_omit,\n     lines(arrange(data.frame(age, fitted(model_multi_age_N)), age),\n           lty=1, lwd=3, col='tomato'))\nsummary(model_multi_age_O)\nanova(model_multi_age_O)\n```\n\n# 분석: 개방성(O) 또한 20세 근처에서 최대였다가 나이가 많아질수록 감소함.\n\n# 다중 선형 회귀(교육과 각 설문항목)\n\n```{r}\n# education~sum_A+sum_C+sum_E+sum_N+sum_O\nbfiDF_e_sum <- subset(bfiDF_omit,\n                      select=c(27, 32:36))\ncor(bfiDF_e_sum)\nplot(bfiDF_e_sum, pch=19, col='steelblue')\nform_2 = education ~ sum_A+sum_C+sum_E+sum_N+sum_O\nlm(form_2, data = bfiDF_e_sum)\nsummary(lm(form_2, data = bfiDF_e_sum))\n```\n\n# stargazer\n\n```{r}\nlibrary(stargazer)\nstargazer(lm(form_2, data = bfiDF_e_sum), type='text')\n```\n\n# 설문항목 A, C, N이 교육수준과 회귀계수가 높음을 확인 했으나 설문항목과 교육수준의 상관관계가 약하므로 높은 회귀계수는 의미가 없음을 확인\n\n```{r}\nlibrary(car)\nscatterplotMatrix(bfiDF_omit[29:35], pch = 19, col = \"steelblue\", cex = 1.2,\nregLine = list(method = lm, lwd = 2, col = \"tomato\"), smooth = list(smoother = loessLine, spread = FALSE,\n                                  lwd.smooth = 2, col.smooth = \"orange\"))\n```\n\n# 항목 합들을 구간을 나누기(3구간)\n\n```{r}\nstr(bfiDF_omit)\n# A----\nbfiDF_omit$sum_A_3 <- cut(bfiDF_omit$sum_A, breaks = c(0,10,20,30),\n    labels = c(10, 20, 30))\ntable(bfiDF_omit$sum_A_3)\n  # 0~10 10~20 20~30 \n  #  19   807  1410 \n# C----\nbfiDF_omit$sum_C_3 <- cut(bfiDF_omit$sum_C, breaks = c(0,10,20,30),\n    labels = c(10, 20, 30))\ntable(bfiDF_omit$sum_C_3)\n # 0~10 10~20 20~30 \n #    8  1600   628 \n# E----\nbfiDF_omit$sum_E_3 <- cut(bfiDF_omit$sum_E, breaks = c(0,10,20,30),\n    labels = c(10, 20, 30))\ntable(bfiDF_omit$sum_E_3)\n # 0~10 10~20 20~30 \n #    4  1681   551 \n# N----\nbfiDF_omit$sum_N_3 <- cut(bfiDF_omit$sum_N, breaks = c(0,10,20,30),\n    labels = c(10, 20, 30))\ntable(bfiDF_omit$sum_N_3)\n # 0~10 10~20 20~30 \n #  491  1235   510 \n# O----\nbfiDF_omit$sum_O_3 <- cut(bfiDF_omit$sum_O, breaks = c(0,10,20,30),\n    labels = c(10, 20, 30))\ntable(bfiDF_omit$sum_O_3)\n # 0~10 10~20 20~30 \n #    5  1573   658 \n```\n\n# 구간 나눈 항목들 그래프\n\n```{r}\npar(mfrow=c(3,2))\nbarplot(table(bfiDF_omit$sum_A_3), main='Agreeableness_3') # 20~30점 이 가장 많음\nbarplot(table(bfiDF_omit$sum_C_3), main='Conscientiousness_3') # 10~20점 이 가장 많음\nbarplot(table(bfiDF_omit$sum_E_3), main='Exraversion_3') # 10~20점 이 가장 많음\nbarplot(table(bfiDF_omit$sum_N_3), main='Neuroticism_3') # 10~20점 이 가장 많음\nbarplot(table(bfiDF_omit$sum_O_3), main='Openness_3') # 10~20점 이 가장 많음\n```\n\n```{r}\n\ntable(bfiDF_omit$sum_A_3)\ntable(bfiDF_omit$sum_C_3)\ntable(bfiDF_omit$sum_E_3)\ntable(bfiDF_omit$sum_N_3)\ntable(bfiDF_omit$sum_O_3)\n```\n\n# 단순선형회귀(나이와 항목A)\n\n# `{r} # # 종속변수 :  age # # 독립변수 :  항목? # form_age_sA3 <- age~sum_A_3 # model_age_sA3 <- lm(formula=form_age_sA3, data=bfiDF_omit) # abline(model_age_sA3, lwd=2, col='tomato') # summary(model_age_sA3) # anova(model_age_sA3) # 0.007314 ** #`\n\n# 박스플롯(age\\~각 항목 3구간)\n\n```{r}\nplot(age~sum_A_3, data=bfiDF_omit, pch=19,\n\ncol='steelblue')\n\nplot(age~sum_C_3, data=bfiDF_omit, pch=19,\n\ncol='steelblue')\n\nplot(age~sum_E_3, data=bfiDF_omit, pch=19,\n\ncol='steelblue')\n\nplot(age~sum_N_3, data=bfiDF_omit, pch=19,\n\ncol='steelblue')\n\nplot(age~sum_O_3, data=bfiDF_omit, pch=19,\n\ncol='steelblue')\n\n```\n\n```{r}\nform_A_3 <- age~sum_A_3\nform_C_3 <- age~sum_C_3\nform_E_3 <- age~sum_E_3\nform_N_3 <- age~sum_N_3\nform_O_3 <- age~sum_O_3\nmodel_A_3 <- lm(formula=form_A_3, data=bfiDF_omit)\nmodel_C_3 <- lm(formula=form_C_3, data=bfiDF_omit)\nmodel_E_3 <- lm(formula=form_E_3, data=bfiDF_omit)\nmodel_N_3 <- lm(formula=form_N_3, data=bfiDF_omit)\nmodel_O_3 <- lm(formula=form_O_3, data=bfiDF_omit)\n# abline(model_A_3, lwd=2, col='tomato')\nsummary(model_A_3)\nsummary(model_C_3)\nsummary(model_E_3)\nsummary(model_N_3)\nsummary(model_O_3)\nanova(model_A_3) # 0.007314 **\nanova(model_C_3) # 0.001918 **\nanova(model_E_3) # 0.09644\nanova(model_N_3) # 1.451e-08 ***\nanova(model_O_3) # 0.04753 *\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["style.css"],"output-file":"yeongchan.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","theme":"cosmo","title":"yeongchan","author":"yc","editor":"visual"},"extensions":{"book":{"multiFile":true}}}}}